Computational
 
Implementation
 
of
 
Training
 
Load
 
Algorithms:
 
A
 
Mathematical
 
and
 
Algorithmic
 
Analysis
 
of
 
Athletic
 
Performance
 
Metrics
 
1.
 
Introduction:
 
The
 
Systems
 
Theory
 
of
 
Human
 
Performance
 
The
 
modern
 
quantification
 
of
 
athletic
 
training
 
is
 
fundamentally
 
an
 
exercise
 
in
 
biological
 
signal
 
processing.
 
It
 
rests
 
on
 
the
 
premise
 
that
 
the
 
human
 
organism's
 
response
 
to
 
physical
 
stress
 
can
 
be
 
modeled
 
as
 
a
 
deterministic
 
system,
 
where
 
training
 
inputs
 
(impulses)
 
produce
 
predictable
 
adaptations
 
(responses)
 
over
 
time.
 
This
 
discipline,
 
situated
 
at
 
the
 
intersection
 
of
 
exercise
 
physiology
 
and
 
computational
 
data
 
science,
 
seeks
 
to
 
translate
 
stochastic
 
telemetry
 
data—second-by-second
 
records
 
of
 
power,
 
heart
 
rate,
 
and
 
velocity—into
 
actionable
 
metrics
 
of
 
homeostasis.
 
The
 
core
 
challenge
 
in
 
this
 
domain
 
is
 
the
 
"dosage-response"
 
problem.
 
Unlike
 
mechanical
 
systems,
 
biological
 
systems
 
are
 
non-linear
 
and
 
time-variant.
 
A
 
training
 
session
 
of
 
a
 
specific
 
magnitude
 
does
 
not
 
yield
 
an
 
immediate,
 
fixed
 
unit
 
of
 
fitness;
 
rather,
 
it
 
initiates
 
a
 
cascade
 
of
 
physiological
 
signaling
 
pathways
 
that
 
decay
 
and
 
accumulate
 
at
 
different
 
rates.
 
To
 
manage
 
this
 
complexity,
 
sports
 
scientists
 
and
 
software
 
engineers
 
have
 
developed
 
a
 
standardized
 
mathematical
 
framework
 
known
 
as
 
the
 
Performance
 
Management
 
Chart
 
(PMC),
 
which
 
relies
 
on
 
specific
 
algorithms
 
to
 
quantify
 
intensity
 
(Normalized
 
Power,
 
Intensity
 
Factor),
 
load
 
(Training
 
Stress
 
Score),
 
and
 
long-term
 
state
 
(Chronic
 
and
 
Acute
 
Training
 
Loads).
 
This
 
report
 
provides
 
an
 
exhaustive
 
analysis
 
of
 
these
 
algorithms.
 
We
 
will
 
deconstruct
 
the
 
mathematical
 
derivations
 
of
 
power-based
 
and
 
heart-rate-based
 
metrics,
 
examine
 
the
 
signal
 
processing
 
techniques
 
required
 
to
 
implement
 
them
 
in
 
code,
 
and
 
explore
 
the
 
advanced
 
methodologies
 
used
 
for
 
normalizing
 
running
 
pace
 
and
 
detecting
 
physiological
 
thresholds.
 
By
 
treating
 
the
 
athlete
 
as
 
a
 
time-series
 
object,
 
we
 
can
 
apply
 
principles
 
from
 
control
 
theory—specifically
 
impulse-response
 
models
 
and
 
exponential
 
smoothing—to
 
construct
 
a
 
digital
 
twin
 
of
 
the
 
athlete's
 
physiological
 
state.
1
 
1.1
 
Historical
 
Context:
 
From
 
Banister
 
to
 
Coggan
 
The
 
foundational
 
architecture
 
of
 
modern
 
training
 
load
 
monitoring
 
was
 
established
 
by
 
Dr.
 
Eric
 
Banister
 
in
 
1975.
 
Banister
 
proposed
 
the
 
"Impulse-Response"
 
model,
 
hypothesizing
 
that
 
performance
 
is
 
a
 
function
 
of
 
two
 
decaying
 
variables:
 
Fitness
 
(positive
 
adaptation)
 
and
 
Fatigue
 
(negative
 
adaptation).
 
Mathematically,
 
this
 
was
 
expressed
 
as
 
a
 
transfer
 
function
 
where
 
a
 
training
 
impulse
 
($w(t)$)
 
drives
 
two
 
separate
 
feedback
 
loops,
 
each
 
governed
 
by
 
its
 
own
 
time
 

---PAGE---

constant.
 
 
$$P(t)
 
=
 
k_1
 
e^{-t/\tau_1}
 
-
 
k_2
 
e^{-t/\tau_2}$$
 
While
 
Banister's
 
model
 
used
 
heart
 
rate
 
to
 
define
 
the
 
impulse
 
(TRIMP),
 
Dr.
 
Andrew
 
Coggan
 
evolved
 
this
 
framework
 
in
 
the
 
early
 
2000s
 
to
 
utilize
 
power
 
data
 
from
 
cycling.
 
Coggan's
 
contribution
 
was
 
the
 
formalization
 
of
 
"Normalized
 
Power"
 
to
 
account
 
for
 
the
 
stochastic
 
nature
 
of
 
bicycle
 
racing
 
and
 
the
 
"Training
 
Stress
 
Score"
 
(TSS)
 
to
 
quantify
 
load
 
relative
 
to
 
functional
 
threshold.
 
These
 
metrics—CTL,
 
ATL,
 
and
 
TSB—are
 
direct
 
descendants
 
of
 
Banister's
 
fitness
 
and
 
fatigue
 
curves,
 
adapted
 
for
 
the
 
precision
 
of
 
power
 
meters.
1
 
2.
 
Signal
 
Processing
 
of
 
Power
 
Data:
 
Normalized
 
Power
 
and
 
Intensity
 
Factor
 
In
 
the
 
implementation
 
of
 
training
 
load
 
algorithms,
 
the
 
raw
 
input
 
is
 
typically
 
a
 
time
 
series
 
of
 
power
 
values,
 
sampled
 
at
 
1
 
Hz
 
(one
 
sample
 
per
 
second).
 
The
 
first
 
challenge
 
is
 
that
 
metabolic
 
cost
 
does
 
not
 
scale
 
linearly
 
with
 
mechanical
 
power
 
output.
 
A
 
linear
 
average
 
of
 
power
 
data
 
underestimates
 
the
 
physiological
 
strain
 
of
 
variable
 
efforts,
 
such
 
as
 
those
 
found
 
in
 
criteriums
 
or
 
mountain
 
biking.
 
To
 
solve
 
this,
 
the
 
concept
 
of
 
Normalized
 
Power
 
(NP)
 
was
 
introduced.
 
2.1
 
Normalized
 
Power
 
(NP):
 
The
 
Stochastic
 
Cost
 
Function
 
Normalized
 
Power
 
is
 
an
 
estimate
 
of
 
the
 
power
 
that
 
an
 
athlete
 
could
 
have
 
maintained
 
for
 
the
 
same
 
physiological
 
"cost"
 
if
 
their
 
power
 
output
 
had
 
been
 
perfectly
 
constant.
 
It
 
is
 
a
 
weighted
 
average
 
that
 
emphasizes
 
higher
 
power
 
values,
 
reflecting
 
the
 
curvilinear
 
relationship
 
between
 
intensity
 
and
 
glycogen
 
utilization/lactate
 
accumulation.
1
 
2.1.1
 
Physiological
 
Justification
 
for
 
the
 
Algorithm
 
The
 
physiological
 
rationale
 
for
 
the
 
NP
 
algorithm
 
rests
 
on
 
two
 
key
 
observations:
 
1.
 
Temporal
 
Lag
:
 
Physiological
 
responses
 
(heart
 
rate,
 
oxygen
 
uptake,
 
lactate
 
appearance)
 
are
 
damped
 
systems.
 
They
 
do
 
not
 
respond
 
instantaneously
 
to
 
changes
 
in
 
power.
 
There
 
is
 
a
 
kinetic
 
lag,
 
typically
 
ranging
 
from
 
25
 
to
 
45
 
seconds
 
for
 
the
 
"fast
 
component"
 
of
 
VO2
 
kinetics.
 
2.
 
Non-Linearity
:
 
The
 
accumulation
 
of
 
metabolic
 
byproducts
 
(lactate,
 
H+
 
ions)
 
rises
 
exponentially
 
with
 
intensity.
 
To
 
model
 
these,
 
the
 
NP
 
algorithm
 
applies
 
a
 
30-second
 
moving
 
average
 
(to
 
mimic
 
the
 
temporal
 
lag)
 
and
 
a
 
4th-power
 
weighting
 
(to
 
mimic
 
the
 
non-linear
 
cost).
 
2.1.2
 
Algorithmic
 
Step-by-Step
 
Implementation
 
The
 
calculation
 
of
 
NP
 
involves
 
four
 
distinct
 
mathematical
 
operations
 
performed
 
on
 
the
 
power
 
time
 
series
 
$P
 
=
 
\{p_1,
 
p_2,...,
 
p_n\}$.
 
Step
 
1:
 
Smoothing
 
(The
 
Rolling
 
Average)
 
The
 
raw
 
data
 
is
 
smoothed
 
using
 
a
 
30-second
 
rolling
 
average.
 
This
 
creates
 
a
 
new
 
time
 
series
 
$P_{30}$,
 
where
 
each
 
point
 
represents
 
the
 
sustained
 
power
 
of
 
the
 
preceding
 
30
 
seconds.
 

---PAGE---

Let
 
$P(t)$
 
be
 
the
 
instantaneous
 
power
 
at
 
second
 
$t$.
 
 
 
$$P_{30}(t)
 
=
 
\frac{1}{30}
 
\sum_{i=0}^{29}
 
P(t-i)$$
 
Step
 
2:
 
Weighting
 
(The
 
4th
 
Power)
 
Each
 
value
 
in
 
the
 
smoothed
 
series
 
is
 
raised
 
to
 
the
 
fourth
 
power.
 
This
 
is
 
the
 
critical
 
step
 
that
 
penalizes
 
variability.
 
By
 
raising
 
the
 
values
 
to
 
the
 
fourth
 
power,
 
high-intensity
 
efforts
 
are
 
magnified
 
significantly
 
more
 
than
 
low-intensity
 
recovery
 
periods
 
are
 
minimized.
 
 
 
$$P_{weighted}(t)
 
=
 
(P_{30}(t))^4$$
 
Step
 
3:
 
Integration
 
and
 
Averaging
 
The
 
average
 
of
 
these
 
4th-power
 
values
 
is
 
calculated
 
over
 
the
 
duration
 
of
 
the
 
segment
 
or
 
activity.
 
 
 
$$P_{avg\_weighted}
 
=
 
\frac{1}{N}
 
\sum_{t=1}^{N}
 
P_{weighted}(t)$$
 
Step
 
4:
 
Normalization
 
(The
 
4th
 
Root)
 
Finally,
 
the
 
4th
 
root
 
of
 
the
 
average
 
is
 
taken
 
to
 
return
 
the
 
metric
 
to
 
the
 
original
 
units
 
(Watts).
 
 
 
$$NP
 
=
 
\sqrt{P_{avg\_weighted}}$$
 
2.1.3
 
Implementation
 
in
 
Python
 
When
 
implementing
 
this
 
algorithm,
 
handling
 
data
 
edges
 
and
 
null
 
values
 
is
 
critical.
 
The
 
rolling
 
window
 
operation
 
inherently
 
produces
 
NaN
 
(Not
 
a
 
Number)
 
values
 
for
 
the
 
first
 
29
 
seconds
 
of
 
the
 
series.
 
Standard
 
implementation
 
guidelines
 
suggest
 
discarding
 
these
 
initial
 
values
 
to
 
prevent
 
skewing
 
the
 
average
 
with
 
incomplete
 
windows.
6
 
 
Python
 
 
 
import
 
pandas
 
as
 
pd
 
import
 
numpy
 
as
 
np
 
 
def
 
calculate_normalized_power(power_series):
 
    
"""
 
    
Calculates
 
the
 
Coggan
 
Normalized
 
Power
 
(NP)
 
from
 
a
 
series
 
of
 
power
 
data.
 
    
 
    
Parameters:
 
    
power_series
 
(pd.Series
 
or
 
list):
 
A
 
time
 
series
 
of
 
power
 
values
 
(Watts),
 
sampled
 
at
 
1Hz.
 
    
 
    
Returns:
 

---PAGE---

    
float:
 
The
 
Normalized
 
Power
 
value.
 
    
"""
 
    
#
 
Ensure
 
input
 
is
 
a
 
pandas
 
Series
 
for
 
vectorized
 
rolling
 
operations
 
    
if
 
not
 
isinstance(power_series,
 
pd.Series):
 
        
power_series
 
=
 
pd.Series(power_series)
 
    
 
    
#
 
Step
 
1:
 
30-second
 
rolling
 
average.
 
    
#
 
We
 
strictly
 
require
 
30
 
observations;
 
the
 
first
 
29
 
points
 
become
 
NaN.
 
    
rolling_avg
 
=
 
power_series.rolling(window=30,
 
min_periods=30).mean()
 
    
 
    
#
 
Step
 
2:
 
Raise
 
to
 
the
 
4th
 
power.
 
    
rolling_pow4
 
=
 
rolling_avg
 
**
 
4
 
    
 
    
#
 
Step
 
3:
 
Calculate
 
the
 
mean
 
of
 
the
 
powered
 
values.
 
    
#
 
Note:
 
mean()
 
in
 
pandas
 
automatically
 
ignores
 
NaNs,
 
effectively
 
discarding
 
    
#
 
the
 
undefined
 
initial
 
window.
 
    
avg_pow4
 
=
 
rolling_pow4.mean()
 
    
 
    
#
 
Step
 
4:
 
Take
 
the
 
4th
 
root.
 
    
normalized_power
 
=
 
avg_pow4
 
**
 
0.25
 
    
 
    
#
 
Rounding
 
is
 
typical
 
for
 
UI
 
display,
 
but
 
internal
 
precision
 
should
 
be
 
maintained.
 
    
return
 
normalized_power
 
 
2.1.4
 
Edge
 
Cases
 
and
 
Anomalies
 
●
 
Zero
 
Values
:
 
In
 
cycling,
 
coasting
 
(0
 
Watts)
 
is
 
common.
 
Unlike
 
a
 
simple
 
arithmetic
 
mean,
 
where
 
zeros
 
significantly
 
drag
 
down
 
the
 
average,
 
NP
 
is
 
robust
 
against
 
zeros.
 
Because
 
$0^4
 
=
 
0$,
 
coasting
 
periods
 
add
 
nothing
 
to
 
the
 
cumulative
 
sum
 
of
 
the
 
4th
 
powers,
 
but
 
they
 
do
 
increase
 
the
 
count
 
$N$
 
in
 
the
 
denominator.
 
This
 
correctly
 
models
 
the
 
physiology:
 
coasting
 
allows
 
for
 
some
 
recovery
 
(lowering
 
the
 
average
 
cost),
 
but
 
it
 
does
 
not
 
erase
 
the
 
metabolic
 
debt
 
accrued
 
during
 
preceding
 
high-intensity
 
intervals.
5
 
●
 
Short
 
Durations
:
 
The
 
algorithm
 
is
 
unstable
 
for
 
very
 
short
 
durations.
 
For
 
efforts
 
under
 
20
 
minutes,
 
the
 
30-second
 
smoothing
 
window
 
can
 
over-smooth
 
the
 
data,
 
potentially
 
underrepresenting
 
the
 
demands
 
of
 
short,
 
anaerobic
 
bursts.
 
Standard
 
practice
 
suggests
 
relying
 
on
 
Average
 
Power
 
rather
 
than
 
NP
 
for
 
intervals
 
shorter
 
than
 
20
 
minutes.
9
 
2.2
 
Intensity
 
Factor
 
(IF):
 
Contextualizing
 
Power
 
Normalized
 
Power
 
provides
 
a
 
"physiologically
 
smoothed"
 
wattage,
 
but
 
it
 
lacks
 
context.
 
A
 
250W
 
NP
 
effort
 
is
 
a
 
recovery
 
ride
 
for
 
a
 
professional
 
cyclist
 
but
 
a
 
maximal
 
sprint
 
for
 
a
 
novice.
 
To
 
quantify
 
the
 
relative
 
difficulty,
 
we
 
calculate
 
the
 
Intensity
 
Factor
 
(IF).
 
The
 
Intensity
 
Factor
 
is
 
the
 
ratio
 
of
 
Normalized
 
Power
 
to
 
the
 
athlete's
 
Functional
 
Threshold
 

---PAGE---

Power
 
(FTP).
 
 
 
$$IF
 
=
 
\frac{NP}{FTP}$$
 
This
 
metric
 
is
 
dimensionless.
 
It
 
effectively
 
normalizes
 
the
 
load
 
across
 
different
 
athletes
 
or
 
across
 
the
 
same
 
athlete's
 
career
 
as
 
their
 
fitness
 
changes.
 
2.2.1
 
Dynamic
 
Parameter
 
Dependency
 
From
 
a
 
software
 
architecture
 
perspective,
 
calculating
 
IF
 
introduces
 
a
 
dependency
 
on
 
time-variant
 
athlete
 
settings.
 
FTP
 
is
 
not
 
a
 
constant;
 
it
 
fluctuates
 
throughout
 
a
 
season.
 
Therefore,
 
an
 
Activity
 
object
 
cannot
 
simply
 
calculate
 
IF
 
based
 
on
 
the
 
current
 
FTP.
 
It
 
must
 
query
 
the
 
AthleteProfile
 
for
 
the
 
FTP
 
value
 
that
 
was
 
valid
 
on
 
the
 
date
 
the
 
activity
 
occurred
.
1
 
Implementation
 
Logic:
 
 
Python
 
 
 
def
 
get_intensity_factor(normalized_power,
 
activity_date,
 
ftp_history):
 
    
"""
 
    
Calculates
 
IF
 
based
 
on
 
the
 
FTP
 
active
 
on
 
the
 
activity
 
date.
 
    
 
    
ftp_history:
 
A
 
sorted
 
list
 
of
 
dictionaries
 
[{'date':
 
'2023-01-01',
 
'ftp':
 
250},...]
 
    
"""
 
    
#
 
Find
 
the
 
applicable
 
FTP
 
    
applicable_ftp
 
=
 
None
 
    
for
 
entry
 
in
 
ftp_history:
 
        
if
 
entry['date']
 
<=
 
activity_date:
 
            
applicable_ftp
 
=
 
entry['ftp']
 
        
else:
 
            
break
 
            
 
    
if
 
applicable_ftp
 
is
 
None:
 
        
raise
 
ValueError("No
 
valid
 
FTP
 
found
 
for
 
this
 
date.")
 
        
 
    
return
 
normalized_power
 
/
 
applicable_ftp
 
 
2.2.2
 
Variability
 
Index
 
(VI)
 
A
 
derivative
 
metric
 
of
 
NP
 
is
 
the
 
Variability
 
Index
 
(VI),
 
defined
 
as
 
the
 
ratio
 
of
 
Normalized
 
Power
 
to
 
Average
 
Power.
 
 
 
$$VI
 
=
 
\frac{NP}{P_{avg}}$$
 

---PAGE---

 
This
 
metric
 
quantifies
 
the
 
stochasticity
 
of
 
the
 
ride.
 
●
 
VI
 
$\approx$
 
1.0
:
 
Indicates
 
a
 
perfectly
 
steady
 
effort
 
(e.g.,
 
a
 
Time
 
Trial
 
or
 
triathlon
 
bike
 
leg).
 
●
 
VI
 
>
 
1.2:
 
Indicates
 
a
 
highly
 
variable
 
effort
 
(e.g.,
 
a
 
criterium
 
or
 
a
 
hilly
 
route
 
with
 
coasting).
 
Physiologically,
 
a
 
high
 
VI
 
implies
 
a
 
greater
 
reliance
 
on
 
glycogen
 
and
 
Type
 
II
 
muscle
 
fibers,
 
even
 
if
 
the
 
average
 
power
 
is
 
moderate.1
 
3.
 
The
 
Stress
 
Integral:
 
Training
 
Stress
 
Score
 
(TSS)
 
and
 
Derivatives
 
While
 
Normalized
 
Power
 
and
 
Intensity
 
Factor
 
describe
 
the
 
nature
 
of
 
a
 
workout,
 
they
 
do
 
not
 
quantify
 
the
 
total
 
magnitude
 
of
 
the
 
training
 
load.
 
A
 
10-minute
 
effort
 
at
 
IF
 
1.0
 
is
 
vastly
 
different
 
from
 
a
 
60-minute
 
effort
 
at
 
IF
 
1.0.
 
To
 
solve
 
this,
 
the
 
Training
 
Stress
 
Score
 
(TSS)
 
integrates
 
intensity
 
and
 
duration
 
into
 
a
 
single
 
numerical
 
index.
 
3.1
 
The
 
TSS
 
Equation
 
The
 
derivation
 
of
 
TSS
 
is
 
anchored
 
to
 
a
 
standard
 
reference
 
point:
 
One
 
hour
 
at
 
Functional
 
Threshold
 
Power
 
(FTP)
 
yields
 
100
 
TSS
 
points.
 
The
 
formula
 
is:
 
 
 
$$TSS
 
=
 
\frac{t_{sec}
 
\times
 
NP
 
\times
 
IF}{FTP
 
\times
 
3600}
 
\times
 
100$$
 
By
 
substituting
 
$IF
 
=
 
NP/FTP$,
 
we
 
can
 
rewrite
 
this
 
to
 
reveal
 
the
 
mathematical
 
weighting
 
of
 
intensity:
 
 
 
$$TSS
 
=
 
\frac{t_{sec}
 
\times
 
NP^2}{FTP^2
 
\times
 
3600}
 
\times
 
100$$
 
or
 
 
$$TSS
 
=
 
t_{hours}
 
\times
 
IF^2
 
\times
 
100$$
 
This
 
quadratic
 
relationship
 
($IF^2$)
 
is
 
profound.
 
It
 
implies
 
that
 
training
 
stress
 
increases
 
exponentially
 
with
 
intensity.
 
Doubling
 
the
 
duration
 
of
 
a
 
ride
 
($t
 
\times
 
2$)
 
doubles
 
the
 
TSS.
 
However,
 
doubling
 
the
 
intensity
 
($IF
 
\times
 
2$)
 
quadruples
 
the
 
TSS.
 
This
 
aligns
 
with
 
the
 
physiological
 
reality
 
that
 
intensity
 
is
 
the
 
primary
 
driver
 
of
 
homeostatic
 
disruption.
1
 
Table
 
1:
 
Impact
 
of
 
Intensity
 
on
 
TSS
 
accumulation
 
per
 
hour
 
Intensity
 
Description
 
Intensity
 
Factor
 
(IF)
 
IF2
 
TSS
 
per
 
Hour
 
Recovery
 
0.50
 
0.25
 
25
 
Endurance
 
0.65
 
0.42
 
42
 
Tempo
 
0.80
 
0.64
 
64
 
Threshold
 
1.00
 
1.00
 
100
 
VO2
 
Max
 
1.15
 
1.32
 
132
 

---PAGE---

3.2
 
Running
 
Training
 
Stress
 
Score
 
(rTSS)
 
and
 
NGP
 
Applying
 
the
 
TSS
 
framework
 
to
 
running
 
presents
 
a
 
challenge:
 
mechanical
 
power
 
is
 
difficult
 
to
 
measure
 
directly.
 
While
 
running
 
power
 
meters
 
(e.g.,
 
Stryd)
 
exist,
 
the
 
vast
 
majority
 
of
 
historical
 
and
 
current
 
data
 
relies
 
on
 
pace.
 
However,
 
pace
 
is
 
a
 
flawed
 
proxy
 
for
 
intensity
 
because
 
it
 
is
 
heavily
 
influenced
 
by
 
gradient.
 
A
 
5:00/km
 
pace
 
on
 
a
 
10%
 
incline
 
represents
 
a
 
much
 
higher
 
metabolic
 
output
 
than
 
on
 
a
 
flat
 
road.
 
To
 
calculate
 
rTSS,
 
we
 
must
 
first
 
normalize
 
the
 
pace
 
to
 
account
 
for
 
gradient.
 
This
 
yields
 
Normalized
 
Graded
 
Pace
 
(NGP)
.
 
3.2.1
 
The
 
Minetti
 
Equation
 
for
 
Energy
 
Cost
 
The
 
normalization
 
of
 
pace
 
relies
 
on
 
bio-energetic
 
models
 
of
 
locomotion.
 
The
 
most
 
widely
 
cited
 
model
 
is
 
by
 
Minetti
 
et
 
al.
 
(2002),
 
which
 
defines
 
the
 
Energy
 
Cost
 
of
 
Transport
 
($C_r$,
 
expressed
 
in
 
$J
 
\cdot
 
kg^{-1}
 
\cdot
 
m^{-1}$)
 
as
 
a
 
polynomial
 
function
 
of
 
the
 
gradient
 
($i$).
 
The
 
polynomial
 
approximation
 
for
 
the
 
cost
 
of
 
running
 
is:
 
 
 
$$C_r(i)
 
=
 
155.4i^5
 
-
 
30.4i^4
 
-
 
43.3i^3
 
+
 
46.3i^2
 
+
 
19.5i
 
+
 
3.6$$
 
Where
 
$i$
 
is
 
the
 
gradient
 
fraction
 
(rise/run).
 
Note
 
that
 
on
 
flat
 
ground
 
($i=0$),
 
the
 
cost
 
is
 
roughly
 
$3.6
 
J
 
\cdot
 
kg^{-1}
 
\cdot
 
m^{-1}$.
 
To
 
calculate
 
NGP,
 
we
 
determine
 
an
 
adjustment
 
factor
 
for
 
each
 
data
 
point:
 
 
 
$$Factor(i)
 
=
 
\frac{C_r(i)}{C_r(0)}$$
 
The
 
Normalized
 
Graded
 
Speed
 
($V_{ngp}$)
 
is
 
then:
 
 
 
$$V_{ngp}
 
=
 
V_{actual}
 
\times
 
Factor(i)$$
 
This
 
creates
 
a
 
"flat-equivalent"
 
speed.
 
For
 
example,
 
running
 
up
 
a
 
steep
 
hill
 
might
 
yield
 
a
 
factor
 
of
 
1.5,
 
meaning
 
a
 
6:00/km
 
actual
 
pace
 
is
 
credited
 
as
 
a
 
4:00/km
 
metabolic
 
effort.
11
 
3.2.2
 
Strava's
 
Grade
 
Adjusted
 
Pace
 
(GAP)
 
Strava
 
utilizes
 
a
 
proprietary
 
variation
 
of
 
this
 
concept
 
called
 
Grade
 
Adjusted
 
Pace
 
(GAP).
 
While
 
Minetti's
 
equation
 
was
 
derived
 
from
 
treadmill
 
studies,
 
Strava's
 
algorithm
 
is
 
trained
 
on
 
massive
 
datasets
 
of
 
outdoor
 
running,
 
incorporating
 
heart
 
rate
 
data
 
to
 
infer
 
effort.
 
Reverse
 
engineering
 
of
 
the
 
GAP
 
algorithm
 
suggests
 
a
 
similar
 
polynomial
 
structure
 
but
 
with
 
coefficients
 
optimized
 
for
 
real-world
 
terrain
 
(which
 
includes
 
surface
 
roughness
 
not
 
present
 
in
 
labs).
 
 
 
$$GAP_{factor}
 
\approx
 
1
 
+
 
0.03i
 
+
 
0.0018i^2
 
+
 
\dots$$
 
13
 

---PAGE---

3.2.3
 
Calculating
 
rTSS
 
Once
 
the
 
NGP
 
is
 
determined
 
for
 
a
 
run,
 
rTSS
 
is
 
calculated
 
using
 
the
 
standard
 
TSS
 
formula,
 
substituting
 
Pace
 
for
 
Power.
 
 
 
$$rTSS
 
=
 
\frac{t_{sec}
 
\times
 
(NGP
 
/
 
FTP_{pace})^2}{3600}
 
\times
 
100$$
 
Some
 
implementations
 
include
 
a
 
specific
 
weighting
 
factor
 
($W$)
 
to
 
account
 
for
 
the
 
eccentric
 
muscle
 
damage
 
(impact
 
trauma)
 
inherent
 
in
 
running,
 
which
 
is
 
absent
 
in
 
cycling.
 
However,
 
TrainingPeaks
 
normalizes
 
this
 
by
 
assuming
 
the
 
"100
 
points
 
per
 
hour
 
at
 
threshold"
 
standard
 
applies
 
regardless
 
of
 
modality,
 
implicitly
 
accepting
 
that
 
1
 
hour
 
of
 
threshold
 
running
 
is
 
"100
 
units
 
of
 
stress"
 
just
 
as
 
1
 
hour
 
of
 
threshold
 
cycling
 
is,
 
despite
 
the
 
different
 
physiological
 
mechanisms.
16
 
3.3
 
Heart
 
Rate
 
Training
 
Stress
 
(hrTSS)
 
and
 
TRIMP
 
When
 
neither
 
power
 
nor
 
GPS
 
pace
 
is
 
available
 
(e.g.,
 
indoor
 
cardio,
 
circuit
 
training),
 
Heart
 
Rate
 
is
 
used.
 
The
 
foundational
 
metric
 
here
 
is
 
TRIMP
 
(Training
 
Impulse)
,
 
developed
 
by
 
Banister.
 
3.3.1
 
TRIMP
 
Derivation
 
TRIMP
 
uses
 
Heart
 
Rate
 
Reserve
 
(HRR)
 
to
 
quantify
 
intensity.
 
 
 
$$HRR_{ratio}
 
=
 
\frac{HR_{ex}
 
-
 
HR_{rest}}{HR_{max}
 
-
 
HR_{rest}}$$
 
The
 
formula
 
accounts
 
for
 
the
 
non-linear
 
accumulation
 
of
 
lactate
 
using
 
an
 
exponential
 
term:
 
 
 
$$TRIMP
 
=
 
t_{min}
 
\times
 
HRR_{ratio}
 
\times
 
0.64
 
\times
 
e^{y
 
\cdot
 
HRR_{ratio}}$$
 
Where
 
$y$
 
is
 
a
 
gender-specific
 
constant
 
derived
 
from
 
lactate
 
profile
 
curves:
 
●
 
$y
 
=
 
1.92$
 
for
 
males
 
●
 
$y
 
=
 
1.67$
 
for
 
females
 
3.3.2
 
Mapping
 
TRIMP
 
to
 
TSS
 
(hrTSS)
 
The
 
raw
 
TRIMP
 
score
 
does
 
not
 
align
 
with
 
the
 
0-100
 
TSS
 
scale.
 
To
 
integrate
 
TRIMP-based
 
activities
 
into
 
the
 
PMC,
 
it
 
must
 
be
 
converted
 
to
 
hrTSS.
 
The
 
standard
 
method
 
is:
 
1.
 
Calculate
 
the
 
athlete's
 
Lactate
 
Threshold
 
Heart
 
Rate
 
(LTHR).
 
2.
 
Calculate
 
the
 
TRIMP
 
score
 
that
 
would
 
accumulate
 
in
 
1
 
hour
 
at
 
LTHR.
 
Let
 
this
 
be
 
$TRIMP_{threshold\_hour}$.
 
3.
 
Calculate
 
the
 
actual
 
TRIMP
 
of
 
the
 
workout
 
($TRIMP_{actual}$).
 
4.
 
$$hrTSS
 
=
 
\frac{TRIMP_{actual}}{TRIMP_{threshold\_hour}}
 
\times
 
100$$
 
This
 
scaling
 
allows
 
heart
 
rate
 
data
 
to
 
coexist
 
with
 
power
 
data
 
in
 
the
 
same
 
longitudinal
 
tracking
 
models.
4
 

---PAGE---

4.
 
Temporal
 
Modeling:
 
The
 
Performance
 
Management
 
Chart
 
(PMC)
 
The
 
collection
 
of
 
daily
 
TSS
 
values
 
provides
 
a
 
sequence
 
of
 
impulses.
 
The
 
Performance
 
Management
 
Chart
 
(PMC)
 
is
 
the
 
control
 
system
 
that
 
interprets
 
these
 
impulses
 
to
 
model
 
the
 
athlete's
 
state
 
over
 
time.
 
It
 
uses
 
Exponentially
 
Weighted
 
Moving
 
Averages
 
(EWMA)
 
to
 
model
 
the
 
decay
 
of
 
training
 
effects.
 
4.1
 
The
 
Mathematics
 
of
 
EW MA
 
Unlike
 
a
 
Simple
 
Moving
 
Average
 
(SMA),
 
which
 
drops
 
old
 
data
 
points
 
abruptly,
 
an
 
EWMA
 
retains
 
a
 
memory
 
of
 
all
 
past
 
data
 
points,
 
with
 
their
 
influence
 
decaying
 
exponentially.
 
This
 
mimics
 
the
 
biological
 
reality
 
that
 
a
 
workout
 
done
 
30
 
days
 
ago
 
has
 
a
 
small
 
but
 
non-zero
 
residual
 
effect
 
on
 
current
 
fitness.
 
The
 
recursive
 
formula
 
for
 
an
 
EWMA
 
is:
 
 
 
$$EMA_t
 
=
 
\alpha
 
\cdot
 
x_t
 
+
 
(1
 
-
 
\alpha)
 
\cdot
 
EMA_{t-1}$$
 
 
Where:
 
●
 
$x_t$
 
is
 
the
 
input
 
for
 
today
 
(Daily
 
TSS).
 
●
 
$EMA_{t-1}$
 
is
 
the
 
value
 
from
 
yesterday.
 
●
 
$\alpha$
 
is
 
the
 
smoothing
 
constant
 
($0
 
<
 
\alpha
 
<
 
1$).
 
4.1.1
 
Time
 
Constants
 
(
$\tau$
)
 
In
 
signal
 
processing,
 
the
 
smoothing
 
constant
 
$\alpha$
 
is
 
related
 
to
 
the
 
time
 
constant
 
$\tau$
 
(the
 
time
 
it
 
takes
 
for
 
the
 
unit
 
step
 
response
 
to
 
reach
 
$\approx
 
63.2\%$
 
of
 
the
 
final
 
value,
 
or
 
for
 
the
 
impulse
 
response
 
to
 
decay
 
to
 
$1/e
 
\approx
 
36.8\%$).
 
The
 
rigorous
 
relationship
 
is:
 
 
 
$$\alpha
 
=
 
1
 
-
 
e^{-1/\tau}$$
 
However,
 
the
 
training
 
load
 
algorithms
 
popularized
 
by
 
Coggan
 
and
 
implemented
 
in
 
TrainingPeaks
 
use
 
the
 
approximation:
 
 
 
$$\alpha
 
=
 
\frac{1}{\tau}$$
 
For
 
the
 
default
 
constants
 
used
 
in
 
PMC,
 
the
 
difference
 
is
 
negligible:
 
●
 
For
 
$\tau
 
=
 
42$:
 
$1/42
 
\approx
 
0.02381$
 
vs
 
$1
 
-
 
e^{-1/42}
 
\approx
 
0.02353$.
 
●
 
For
 
$\tau
 
=
 
7$:
 
$1/7
 
\approx
 
0.1428$
 
vs
 
$1
 
-
 
e^{-1/7}
 
\approx
 
0.1331$.
 
The
 
PMC
 
uses
 
the
 
$1/\tau$
 
approximation
 
for
 
computational
 
simplicity
 
and
 
tradition.
21
 

---PAGE---

4.2
 
Chronic
 
Training
 
Load
 
(CTL)
 
-
 
"Fitness"
 
CTL
 
models
 
the
 
long-term
 
training
 
load.
 
●
 
Time
 
Constant
 
($\tau$)
:
 
42
 
days.
 
●
 
Significance
:
 
Adapts
 
slowly
 
to
 
training.
 
Represents
 
the
 
athlete's
 
baseline
 
capacity.
 
Equation:
 
 
 
$$CTL_{today}
 
=
 
CTL_{yesterday}
 
+
 
\frac{TSS_{today}
 
-
 
CTL_{yesterday}}{42}$$
 
Sensitivity
 
Analysis
:
 
The
 
choice
 
of
 
42
 
days
 
is
 
empirical,
 
based
 
on
 
the
 
time
 
course
 
of
 
central
 
cardiovascular
 
adaptations
 
(e.g.,
 
plasma
 
volume
 
expansion,
 
mitochondrial
 
density).
 
Changing
 
$\tau$
 
to
 
60
 
days
 
would
 
make
 
CTL
 
smoother
 
and
 
less
 
responsive;
 
changing
 
it
 
to
 
21
 
days
 
would
 
make
 
it
 
more
 
volatile.
 
The
 
42-day
 
standard
 
provides
 
a
 
balance
 
that
 
matches
 
the
 
subjective
 
"feeling"
 
of
 
fitness
 
for
 
most
 
endurance
 
athletes.
 
4.3
 
Acute
 
Training
 
Load
 
(ATL)
 
-
 
"Fatigue"
 
ATL
 
models
 
the
 
short-term
 
training
 
load.
 
●
 
Time
 
Constant
 
($\tau$)
:
 
7
 
days.
 
●
 
Significance
:
 
Adapts
 
rapidly.
 
Represents
 
the
 
acute
 
stress
 
and
 
sensation
 
of
 
tiredness.
 
Equation:
 
 
 
$$ATL_{today}
 
=
 
ATL_{yesterday}
 
+
 
\frac{TSS_{today}
 
-
 
ATL_{yesterday}}{7}$$
 
4.4
 
Training
 
Stress
 
Balance
 
(TSB)
 
-
 
"Form"
 
TSB
 
models
 
the
 
athlete's
 
readiness
 
to
 
perform.
 
It
 
is
 
the
 
difference
 
between
 
fitness
 
and
 
fatigue.
 
 
 
$$TSB
 
=
 
CTL
 
-
 
ATL$$
 
The
 
"Yesterday"
 
vs.
 
"Today"
 
Implementation
 
Nuance:
 
A
 
critical
 
detail
 
in
 
implementation
 
is
 
the
 
timing
 
of
 
the
 
calculation.
 
TSB
 
is
 
typically
 
used
 
to
 
predict
 
today's
 
readiness
 
before
 
the
 
workout
 
is
 
done.
 
Therefore,
 
the
 
standard
 
implementation
 
calculates
 
TSB
 
using
 
yesterday's
 
CTL
 
and
 
ATL.
 
 
 
$$TSB_{today\_pre\_workout}
 
=
 
CTL_{yesterday}
 
-
 
ATL_{yesterday}$$
 
If
 
one
 
calculates
 
TSB
 
using
 
post-workout
 
values,
 
the
 
TSB
 
will
 
invariably
 
be
 
lower
 
(more
 
fatigued)
 
because
 
the
 
day's
 
workout
 
spikes
 
ATL
 
more
 
than
 
it
 
raises
 
CTL.
 
●
 
Positive
 
TSB
:
 
Indicates
 
freshness
 
(tapering).
 
●
 
Negative
 
TSB
:
 
Indicates
 
loading.
 
●
 
Optimal
 
Taper
:
 
TSB
 
of
 
+15
 
to
 
+25
 
is
 
often
 
cited
 
as
 
the
 
ideal
 
range
 
for
 
race
 
day
 
peak
 

---PAGE---

performance.
2
 
4.5
 
Python
 
Class
 
Architecture
 
for
 
PMC
 
Implementing
 
a
 
robust
 
PMC
 
calculator
 
requires
 
an
 
object-oriented
 
approach
 
to
 
handle
 
state
 
and
 
history.
 
 
Python
 
 
 
class
 
PerformanceManagementChart:
 
    
def
 
__init__(self,
 
start_ctl=0,
 
start_atl=0,
 
tau_ctl=42,
 
tau_atl=7):
 
        
self.ctl
 
=
 
start_ctl
 
        
self.atl
 
=
 
start_atl
 
        
self.tau_ctl
 
=
 
tau_ctl
 
        
self.tau_atl
 
=
 
tau_atl
 
        
self.history
 
=
 
 
    
def
 
process_day(self,
 
date,
 
daily_tss):
 
        
"""
 
        
Processes
 
a
 
single
 
day.
 
Must
 
be
 
called
 
sequentially
 
by
 
date.
 
        
"""
 
        
#
 
Calculate
 
TSB
 
for
 
the
 
start
 
of
 
the
 
day
 
(Pre-workout
 
state)
 
        
#
 
TSB
 
=
 
CTL(yesterday)
 
-
 
ATL(yesterday)
 
        
start_of_day_tsb
 
=
 
self.ctl
 
-
 
self.atl
 
        
 
        
#
 
Update
 
CTL
 
and
 
ATL
 
with
 
the
 
day's
 
stress
 
        
#
 
Using
 
the
 
standard
 
1/tau
 
approximation
 
        
self.ctl
 
=
 
self.ctl
 
+
 
(daily_tss
 
-
 
self.ctl)
 
/
 
self.tau_ctl
 
        
self.atl
 
=
 
self.atl
 
+
 
(daily_tss
 
-
 
self.atl)
 
/
 
self.tau_atl
 
        
 
        
#
 
Record
 
state
 
        
self.history.append({
 
            
'date':
 
date,
 
            
'tss':
 
daily_tss,
 
            
'ctl':
 
round(self.ctl,
 
2),
 
            
'atl':
 
round(self.atl,
 
2),
 
            
'tsb':
 
round(start_of_day_tsb,
 
2)
 
        
})
 
 
    
def
 
get_dataframe(self):
 
        
import
 
pandas
 
as
 
pd
 
        
return
 
pd.DataFrame(self.history)
 
 

---PAGE---

Handling
 
Missing
 
Data
:
 
A
 
common
 
implementation
 
error
 
is
 
to
 
iterate
 
only
 
through
 
the
 
list
 
of
 
activities.
 
If
 
an
 
athlete
 
rests
 
(no
 
activity),
 
there
 
is
 
no
 
TSS
 
record.
 
However,
 
the
 
PMC
 
must
 
still
 
process
 
this
 
day
 
with
 
TSS
 
=
 
0
 
to
 
allow
 
CTL
 
and
 
ATL
 
to
 
decay.
 
The
 
implementation
 
must
 
generate
 
a
 
continuous
 
date
 
range
 
and
 
fill
 
missing
 
activity
 
days
 
with
 
0
 
TSS
 
before
 
processing.
21
 
5.
 
Physiological
 
Thresholds
 
and
 
Drift
 
Algorithms
 
While
 
the
 
PMC
 
tracks
 
load,
 
the
 
inputs
 
(TSS)
 
depend
 
on
 
accurate
 
threshold
 
parameters
 
(FTP,
 
LTHR).
 
Static
 
parameters
 
degrade
 
in
 
accuracy
 
over
 
time.
 
Therefore,
 
modern
 
systems
 
employ
 
detection
 
algorithms
 
to
 
auto-update
 
these
 
thresholds.
 
5.1
 
The
 
95%
 
of
 
20-Minute
 
Peak
 
Algorithm
 
This
 
heuristic
 
is
 
widely
 
used
 
for
 
updating
 
Lactate
 
Threshold
 
Heart
 
Rate
 
(LTHR)
 
and
 
FTP.
 
Algorithm
 
Logic
:
 
1.
 
Scan
:
 
Iterate
 
through
 
the
 
activity
 
data
 
to
 
find
 
the
 
rolling
 
20-minute
 
window
 
with
 
the
 
highest
 
average
 
value
 
(Power
 
or
 
Heart
 
Rate).
 
2.
 
Filter
:
 
Apply
 
validity
 
checks.
 
For
 
LTHR,
 
the
 
variability
 
(standard
 
deviation)
 
of
 
HR
 
during
 
the
 
20-minute
 
window
 
should
 
be
 
low
 
(indicating
 
a
 
steady
 
effort,
 
not
 
intervals).
 
The
 
max
 
HR
 
in
 
the
 
window
 
should
 
effectively
 
be
 
near
 
maximal
 
capacity.
 
3.
 
Calculation:
 
 
$$Estimated\_Threshold
 
=
 
0.95
 
\times
 
Peak_{20min\_avg}$$
 
4.
 
Update
 
Trigger
:
 
If
 
the
 
estimated
 
threshold
 
is
 
significantly
 
higher
 
(>
 
2-3%)
 
than
 
the
 
current
 
setting,
 
trigger
 
an
 
update
 
suggestion.
24
 
5.2
 
Recurrence
 
Quantification
 
Analysis
 
(RQA)
 
for
 
Thresholds
 
A
 
more
 
advanced,
 
non-invasive
 
method
 
for
 
detecting
 
thresholds
 
involves
 
Recurrence
 
Quantification
 
Analysis
 
(RQA)
 
of
 
Heart
 
Rate
 
Variability
 
(HRV)
 
or
 
HR
 
time
 
series.
 
This
 
method
 
detects
 
phase
 
transitions
 
in
 
the
 
dynamic
 
system
 
of
 
the
 
heart.
 
The
 
transition
 
from
 
aerobic
 
to
 
anaerobic
 
metabolism
 
is
 
a
 
bifurcation
 
point
 
where
 
the
 
heart
 
rate
 
signal
 
shifts
 
from
 
a
 
chaotic
 
attractor
 
(high
 
complexity)
 
to
 
a
 
more
 
periodic/rigid
 
attractor
 
(lower
 
complexity
 
due
 
to
 
sympathetic
 
saturation).
 
Algorithmic
 
Concept
:
 
1.
 
Embedding:
 
Construct
 
a
 
phase
 
space
 
trajectory
 
from
 
the
 
HR
 
time
 
series
 
using
 
time-delay
 
embedding.
 
 
$$X_i
 
=
 
[x_i,
 
x_{i+\tau},...,
 
x_{i+(m-1)\tau}]$$
 
2.
 
Recurrence
 
Plot
:
 
Create
 
a
 
binary
 
matrix
 
$R_{i,j}$
 
where
 
$R_{i,j}
 
=
 
1$
 
if
 
the
 
distance
 
between
 
states
 
$X_i$
 
and
 
$X_j$
 
is
 
less
 
than
 
a
 
threshold
 
$\epsilon$.
 
3.
 
Determinism
 
(DET):
 
Calculate
 
the
 
percentage
 
of
 
recurrence
 
points
 
that
 
form
 
diagonal
 
lines
 
in
 
the
 
plot.
 
 
$$DET
 
=
 
\frac{\sum
 
l
 
\cdot
 
P(l)}{\sum
 
l
 
\cdot
 
P(l)}$$
 

---PAGE---

 
(where
 
$P(l)$
 
is
 
the
 
frequency
 
distribution
 
of
 
diagonal
 
line
 
lengths).
 
4.
 
Detection
:
 
Monitor
 
the
 
DET
 
value
 
during
 
an
 
incremental
 
exercise
 
ramp.
 
A
 
sharp
 
inflection
 
point
 
(minima
 
or
 
maxima
 
in
 
DET)
 
correlates
 
strongly
 
with
 
the
 
Aerobic
 
and
 
Anaerobic
 
Thresholds,
 
often
 
providing
 
higher
 
accuracy
 
than
 
the
 
simple
 
95%
 
rule
 
without
 
requiring
 
maximal
 
exhaustion.
26
 
5.3
 
Aerobic
 
Decoupling
 
(Pw:HR)
 
Aerobic
 
decoupling
 
measures
 
the
 
efficiency
 
of
 
the
 
cardiovascular
 
system.
 
In
 
a
 
steady
 
state
 
effort,
 
HR
 
should
 
remain
 
stable
 
relative
 
to
 
Power.
 
"Cardiac
 
Drift"
 
occurs
 
when
 
HR
 
rises
 
over
 
time
 
due
 
to
 
thermoregulation,
 
catecholamine
 
accumulation,
 
and
 
fatigue.
 
The
 
Pw:HR
 
Algorithm:
 
This
 
metric
 
quantifies
 
the
 
divergence
 
between
 
internal
 
load
 
(HR)
 
and
 
external
 
load
 
(Power/Pace).
 
1.
 
Selection
:
 
Identify
 
a
 
segment
 
of
 
the
 
workout
 
that
 
is
 
"steady
 
state."
 
Usually
 
defined
 
as
 
a
 
segment
 
where
 
$VI
 
<
 
1.1$
 
and
 
duration
 
>
 
20
 
minutes.
 
2.
 
Bisection
:
 
Split
 
the
 
segment
 
into
 
two
 
equal
 
time
 
halves:
 
First
 
Half
 
($H_1$)
 
and
 
Second
 
Half
 
($H_2$).
 
3.
 
Efficiency
 
Factor
 
(EF):
 
Calculate
 
the
 
ratio
 
of
 
output
 
to
 
input
 
for
 
each
 
half.
 
 
$$EF_1
 
=
 
\frac{AvgPower_{H1}}{AvgHR_{H1}}$$
 
$$EF_2
 
=
 
\frac{AvgPower_{H2}}{AvgHR_{H2}}$$
 
4.
 
Decoupling
 
Calculation:
 
 
$$Decoupling
 
\%
 
=
 
\left(
 
\frac{EF_1
 
-
 
EF_2}{EF_1}
 
\right)
 
\times
 
100$$
 
Interpretation
:
 
●
 
<
 
5%
:
 
Considered
 
"Coupled."
 
The
 
athlete
 
has
 
good
 
aerobic
 
durability
 
for
 
this
 
intensity/duration.
 
●
 
>
 
5%
:
 
"Decoupled."
 
Indicates
 
significant
 
fatigue
 
or
 
lack
 
of
 
endurance.
 
●
 
Negative
 
Decoupling
:
 
Occasionally
 
seen
 
when
 
HR
 
drops
 
relative
 
to
 
power,
 
often
 
indicating
 
fueling
 
issues
 
or
 
extreme
 
freshness/efficiency
 
improvements,
 
though
 
less
 
common.
28
 
Code
 
Snippet
 
for
 
Decoupling
:
 
 
Python
 
 
 
def
 
calculate_decoupling(power_segment,
 
hr_segment):
 
    
"""
 
    
Calculates
 
Pw:HR
 
decoupling.
 
    
Inputs
 
are
 
lists/arrays
 
of
 
power
 
and
 
HR
 
for
 
the
 
steady
 
interval.
 
    
"""
 

---PAGE---

    
midpoint
 
=
 
len(power_segment)
 
//
 
2
 
    
 
    
#
 
First
 
Half
 
    
p1
 
=
 
np.mean(power_segment[:midpoint])
 
    
h1
 
=
 
np.mean(hr_segment[:midpoint])
 
    
ef1
 
=
 
p1
 
/
 
h1
 
    
 
    
#
 
Second
 
Half
 
    
p2
 
=
 
np.mean(power_segment[midpoint:])
 
    
h2
 
=
 
np.mean(hr_segment[midpoint:])
 
    
ef2
 
=
 
p2
 
/
 
h2
 
    
 
    
#
 
Decoupling
 
    
decoupling
 
=
 
((ef1
 
-
 
ef2)
 
/
 
ef1)
 
*
 
100
 
    
 
    
return
 
decoupling
 
 
6.
 
Advanced
 
Implementation
 
Considerations
 
6.1
 
Data
 
Hygiene
 
and
 
Preprocessing
 
The
 
"Garbage
 
In,
 
Garbage
 
Out"
 
principle
 
is
 
paramount.
 
Training
 
load
 
algorithms
 
are
 
highly
 
sensitive
 
to
 
data
 
errors.
 
●
 
Power
 
Spikes
:
 
A
 
momentary
 
sensor
 
error
 
reading
 
2000
 
Watts
 
for
 
1
 
second
 
will
 
skew
 
Average
 
Power
 
slightly
 
but
 
will
 
skew
 
Normalized
 
Power
 
significantly
 
(due
 
to
 
the
 
4th
 
power
 
weighting).
 
Algorithms
 
must
 
include
 
a
 
pre-processing
 
filter
 
to
 
cap
 
or
 
discard
 
physiologically
 
impossible
 
values
 
(e.g.,
 
>
 
2500W
 
or
 
>
 
5x
 
FTP).
 
●
 
Null
 
Handling
:
 
As
 
discussed,
 
nulls
 
must
 
be
 
distinguished
 
from
 
zeros.
 
In
 
calculating
 
TSS,
 
a
 
null
 
(missing
 
data)
 
contributes
 
to
 
duration
 
($t$)
 
but
 
not
 
to
 
work,
 
effectively
 
treating
 
it
 
as
 
a
 
zero.
 
However,
 
in
 
averaging
 
algorithms,
 
nulls
 
are
 
often
 
skipped.
 
Consistency
 
in
 
this
 
decision
 
is
 
vital
 
for
 
reproducible
 
results.
 
6.2
 
The
 
"Floating
 
FTP"
 
Problem
 
A
 
major
 
architectural
 
challenge
 
is
 
the
 
mutability
 
of
 
history.
 
If
 
an
 
athlete
 
updates
 
their
 
FTP
 
today
 
from
 
250W
 
to
 
275W,
 
should
 
the
 
TSS
 
of
 
a
 
ride
 
from
 
last
 
month
 
change?
 
●
 
Standard
 
Practice
:
 
No.
 
History
 
is
 
immutable.
 
The
 
TSS
 
for
 
a
 
past
 
ride
 
was
 
calculated
 
based
 
on
 
the
 
physiology
 
at
 
that
 
time
.
 
●
 
Implementation
:
 
This
 
requires
 
storing
 
FTP
 
as
 
a
 
time-series
 
object
 
(Effective
 
Date,
 
Value)
 
rather
 
than
 
a
 
single
 
field
 
in
 
the
 
User
 
object.
 
Every
 
TSS
 
calculation
 
must
 
look
 
up
 
the
 
FTP
 
effective
 
at
 
Activity.StartDate.
 
6.3
 
Computational
 
Effi ciency
 

---PAGE---

Calculating
 
PMC
 
for
 
a
 
user
 
with
 
10
 
years
 
of
 
history
 
(3,650
 
days)
 
involves
 
iterating
 
through
 
the
 
EWMA
 
loop
 
3,650
 
times.
 
While
 
$O(N)$
 
is
 
efficient,
 
calculating
 
this
 
on-the-fly
 
for
 
thousands
 
of
 
users
 
in
 
a
 
web
 
application
 
can
 
be
 
costly.
 
●
 
Optimization
:
 
Store
 
the
 
pre-calculated
 
CTL/ATL/TSB
 
values
 
in
 
a
 
daily
 
summary
 
table.
 
Only
 
recalculate
 
the
 
chain
 
from
 
the
 
date
 
of
 
a
 
modified/added
 
activity
 
forward.
 
This
 
reduces
 
the
 
complexity
 
from
 
$O(TotalHistory)$
 
to
 
$O(DaysSinceModification)$.
 
7.
 
Conclusion
 
The
 
mathematical
 
quantification
 
of
 
training
 
load
 
is
 
a
 
powerful
 
fusion
 
of
 
physiological
 
principles
 
and
 
algorithmic
 
logic.
 
By
 
utilizing
 
Normalized
 
Power
,
 
we
 
account
 
for
 
the
 
metabolic
 
cost
 
of
 
variability.
 
By
 
employing
 
TSS
 
and
 
TRIMP
,
 
we
 
integrate
 
volume
 
and
 
intensity
 
into
 
a
 
unified
 
currency
 
of
 
stress.
 
And
 
through
 
the
 
Performance
 
Management
 
Chart
,
 
we
 
use
 
Exponentially
 
Weighted
 
Moving
 
Averages
 
to
 
model
 
the
 
dynamic
 
interplay
 
of
 
fitness
 
and
 
fatigue.
 
For
 
the
 
developer
 
or
 
sports
 
scientist
 
implementing
 
these
 
systems,
 
success
 
lies
 
not
 
just
 
in
 
the
 
formulas,
 
but
 
in
 
the
 
rigorous
 
handling
 
of
 
the
 
data
 
pipeline:
 
managing
 
time-series
 
continuity,
 
ensuring
 
correct
 
parameter
 
history
 
(FTP/LTHR),
 
and
 
understanding
 
the
 
limitations
 
of
 
the
 
models.
 
While
 
no
 
algorithm
 
can
 
perfectly
 
capture
 
the
 
complexity
 
of
 
human
 
biology,
 
these
 
mathematical
 
proxies
 
provide
 
the
 
most
 
robust
 
framework
 
currently
 
available
 
for
 
optimizing
 
human
 
performance.
 
Alıntılanan
 
çalışmalar
 
1.
 
Form ulas
 
from
 
Training
 
and
 
Racing
 
with
 
a
 
Power
 
M eter
 
|
 
G SSNS,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://gssns.io/posts/formulas-training-racing-power-meter/
 
2.
 
ATL,
 
CTL
 
&
 
TSB
 
explained
 
|
 
Ian
 
Barring ton,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://ianbarrington.com/2007/03/02/atl-ctl-tsb-explained/
 
3.
 
Training
 
load
 
m etrics
 
and
 
training
 
stress
 
scores
 
—
 
what
 
are
 
TRIM P,
 
HRSS,
 
and
 
rTSS?,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.veohtu.com/trimp.html
 
4.
 
Form ula
 
to
 
Calculate
 
HrTSS
 
-
 
Training
 
-
 
TrainerRoad,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.trainerroad.com/forum/t/formula-to-calculate-hrtss/22982
 
5.
 
W hat
 
Is
 
Norm alized
 
Power
 
And
 
How
 
Is
 
It
 
Used
 
In
 
Cycling
 
Training ?
 
-
 
CTS,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://trainright.com/normalized-power-what-is-it-how-is-it-used-cycling/
 
6.
 
W hat
 
are
 
CTL,
 
ATL,
 
TSB
 
&
 
TSS?
 
W hy
 
Do
 
They
 
M atter?
 
-
 
Traine rRoad,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.trainerroad.com/blog/why-tss-atl-ctl-and-tsb-matter/
 
7.
 
Cycling
 
Training:
 
Easily
 
Understand
 
Norm alized
 
Power
 
in
 
4
 
Steps
 
...,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://jaylocycling.com/easily-understand-cycling-normalized-power/
 
8.
 
Form ulas
 
from
 
'Training
 
and
 
Racing
 
with
 
a
 
Power
 
M eter'
 
|
 
by
 
Aart
 
G oossens
 
-
 
M edium ,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://medium.com/critical-powers/formulas-from-training-and-racing-with-a-p 
ower-meter-2a295c661b46
 
9.
 
Norm alized
 
Power®:
 
W hat
 
It
 
Is
 
and
 
How
 
to
 
Use
 
It
 
-
 
Traine rRoad
 
Blog,
 
erişim
 
tarihi
 

---PAGE---

Aralık
 
3,
 
2025,
 
https://www.trainerroad.com/blog/normalized-power-what-it-is-and-how-to-use 
-it/
 
10.
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://support.garmin.com/en-US/?faq=lpxtpg6jEh6Hcdxzxcffe5#:~:text=Intensit 
y%20Factor%20(IF)%20is%20an,Functional%20Threshold%20Power%20(FTP).
 
11.
 
m ountain
 
running
 
with
 
golden
 
cheetah
 
and
 
power
 
-
 
graded
 
pace
 
-
 
G oogle
 
G roups,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://groups.google.com/g/golden-cheetah-users/c/PM8pFWbMELo
 
12.
 
Reverse-engineering
 
Strava's
 
G rade
 
Adjus ted
 
Pace
 
-
 
Aaron
 
Schroeder,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://aaron-schroeder.github.io/reverse-engineering/
 
13.
 
If
 
you
 
ever
 
wondered,
 
how
 
Strava'S
 
G AP
 
and
 
TrainingPeaks
 
NG P
 
com pare,
 
here
 
you
 
go
 
-
 
Reddit,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.reddit.com/r/Strava/comments/18ixpim/if_you_ever_wondered_how_ 
stravas_gap_and/
 
14.
 
G rade
 
Adjusted
 
Pace
 
(G AP)
 
-
 
Strava
 
Support,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://support.strava.com/hc/en-us/articles/216917067-Grade-Adjusted-Pace-G 
AP
 
15.
 
W hat
 
is
 
the
 
G rade
 
Adjusted
 
Pace
 
(G AP)
 
?
 
-
 
RunM otion
 
Run ning,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://en.run-motion.com/equivalent-speed-grade-adjusted-pace/
 
16.
 
3
 
TrainingPeaks
 
training
 
m etrics
 
to
 
adjus t
 
your
 
run ning
 
on
 
the
 
go
 
-
 
Suunto,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://us.suunto.com/blogs/blog/3-trainingpeaks-training-metrics-to-adjust-you 
r-running-on-the-go
 
17.
 
Running
 
Training
 
Stress
 
Score
 
(rTSS*)
 
Explaine d
 
-
 
Training Peaks,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.trainingpeaks.com/learn/articles/running-training-stress-score-rtss- 
explained/
 
18.
 
Running
 
Stress
 
Score
 
(RSS)
 
-
 
Stryd
 
Help
 
Center,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://help.stryd.com/en/articles/6879537-running-stress-score-rss
 
19.
 
TRIM P:
 
A
 
Science-Backed
 
W ay
 
to
 
M easur e
 
Training
 
Load
 
in
 
End urance
 
Sports
 
-
 
Ludum ,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://ludum.com/blog/data-performance-analytics/trimp-as-a-training-load-sc 
ore/
 
20.
 
Training
 
with
 
TSS
 
vs.
 
hrTSS:
 
W hat's
 
the
 
difference?
 
-
 
Thom as
 
End urance
 
Coaching,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.thomasendurancecoaching.com/training-with-tss-vs-hrtss-whats-th 
e-difference/
 
21.
 
Calculate
 
Needed
 
Training
 
Load?
 
-
 
Intervals.icu
 
Forum ,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://forum.intervals.icu/t/calculate-needed-training-load/5788
 
22.
 
A
 
Coach's
 
G uide
 
to
 
ATL,
 
CTL
 
&
 
TSB
 
-
 
TrainingPeaks,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.trainingpeaks.com/coach-blog/a-coachs-guide-to-atl-ctl-tsb/
 
23.
 
M anaging
 
Training
 
Load:
 
O ptim ising
 
Cycling
 
Perform ance
 
with
 
TSB,
 
TSS,
 
CTL,
 
and
 
Training
 
Cycles
 
-
 
Cycling-Inform ,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.cycling-inform.com/managing-training-load-optimising-cycling-perf

---PAGE---

ormance-with-tsb-tss-ctl-and-training-cycles
 
24.
 
Power
 
&
 
Heart
 
Rate
 
Threshold
 
Testing
 
For
 
Runni ng
 
&
 
Cycling
 
-
 
M ountain
 
Peak
 
Fitness,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.mountainpeakfitness.com/blog/power-hr-threshold-testing-for-run 
ning-cycling
 
25.
 
Just
 
do
 
a
 
threshold
 
test
 
and
 
m anua lly
 
set
 
your
 
zones
 
:
 
r/G arm in
 
-
 
Reddit,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.reddit.com/r/Garmin/comments/1130yoi/just_do_a_threshold_test_an 
d_manually_set_your/
 
26.
 
Autom atic
 
Detection
 
of
 
Aerobic
 
Threshold
 
through
 
Recur rence
 
Q ua ntification
 
Analysis
 
of
 
Heart
 
Rate
 
Tim e
 
Series
 
-
 
ResearchG ate,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.researchgate.net/publication/367344691_Automatic_Detection_of_A 
erobic_Threshold_through_Recurrence_Quantification_Analysis_of_Heart_Rate_Ti 
me_Series
 
27.
 
Autom atic
 
Detection
 
of
 
Aerobic
 
Threshold
 
through
 
Recur rence
 
Q ua ntification
 
Analysis
 
of
 
Heart
 
Rate
 
Tim e
 
Series
 
-
 
NIH,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://pmc.ncbi.nlm.nih.gov/articles/PMC9916349/
 
28.
 
W hat
 
is
 
(Pw:Hr),
 
Aerobic
 
Decoupling ?
 
|
 
Cycling
 
Coach
 
-
 
Cyklopedia,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://cyklopedia.cc/cycling-tips/what-is-pw-hr-aerobic-decoupling/
 
29.
 
Aerobic
 
decoupling
 
calculation
 
is
 
incorrect
 
:
 
r/Runa lyze
 
-
 
Reddit,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.reddit.com/r/Runalyze/comments/1fo45z3/aerobic_decoupling_calcul 
ation_is_incorrect/
 
30.
 
Are
 
You
 
Fit?
 
All
 
About
 
Aerobic
 
End uranc e
 
and
 
Decoup ling
 
-
 
TrainingPeaks,
 
erişim
 
tarihi
 
Aralık
 
3,
 
2025,
 
https://www.trainingpeaks.com/blog/aerobic-endurance-and-decoupling/
 

---PAGE---

